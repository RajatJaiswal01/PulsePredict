# PulsePredict
A solution to identify and predict any possible adverse event from a recorded conversation between patient and nurse or medical agent. 


# 🩺 PulsePredict: Adverse Event Detection from Medical Call Transcripts

PulsePredict is an end-to-end system that analyzes doctor-patient call recordings to predict the likelihood of adverse medical events using automatic transcription, entity extraction, and machine learning.

---

## 📁 Project Structure

.
├── audio_calls/ # Input: raw doctor-patient call audio
├── cleaned_transcripts/ # Cleaned text for NLP
├── data/ # Static resources like FAERS list
├── entities/ # AWS Comprehend Medical output
├── labeled_entities/ # Entities labeled with adverse event info
├── model/ # Trained ML model (.pkl)
├── new_audio/ # New audio samples for prediction
├── transcripts/ # Transcripts generated by Whisper
├── visualizations/ # Optional charts or plots
├── whisper-env/ # Virtual environment (excluded from Git)
├── scripts/ # Core processing scripts
├── features.csv # Engineered dataset
├── predict_from_audio.py # End-to-end prediction pipeline
├── README.md # Project documentation

yaml
Copy
Edit

---

## 🧠 How It Works

1. Transcribe medical calls using Whisper
2. Extract medical entities using AWS Comprehend Medical
3. Label entities based on FAERS adverse events database
4. Engineer features from labeled entities
5. Train a classifier to predict if an adverse event occurred
6. Run end-to-end predictions on new audio

---

## 🔁 Pipeline: Step-by-Step

### 1️⃣ Transcribe Audio

```bash
python scripts/batch_transcribe.py
Takes .wav or .mp3 files from audio_calls/ and produces raw transcripts in transcripts/.

2️⃣ Preprocess Transcripts
bash
Copy
Edit
python scripts/batch_preprocess_transcripts.py
Cleans the transcripts (lowercase, remove punctuation) and saves them to cleaned_transcripts/.

3️⃣ Extract Medical Entities
bash
Copy
Edit
python scripts/batch_entity_extraction.py
Uses AWS Comprehend Medical to extract entities like symptoms, medications, conditions. Saves output in entities/.

4️⃣ Create FAERS Adverse Events List
bash
Copy
Edit
python scripts/create_faers_adverse_events.py
Builds data/faers_adverse_events.txt — the list of known adverse events used for tagging entities.

5️⃣ Label Entities with FAERS Matches
bash
Copy
Edit
python scripts/label_entities.py
Tags entities from step 3 as is_adverse_event = True/False by matching with FAERS list. Output saved in labeled_entities/.

6️⃣ Feature Engineering
bash
Copy
Edit
python scripts/feature_engineering.py
Creates structured feature vectors for each file (e.g. number of medications, symptoms, adverse events). Output: features.csv.

7️⃣ Train ML Model
bash
Copy
Edit
python scripts/train_model.py
Trains a Random Forest classifier to predict adverse events. Saves model to model/adverse_event_model.pkl.

8️⃣ Evaluate Model
bash
Copy
Edit
python scripts/evaluate_model.py
Compares performance of ML model vs. a rule-based baseline (adverse_event_ratio > 0.3).

9️⃣ Predict from New Audio
bash
Copy
Edit
python predict_from_audio.py new_audio/sample10.mp3
Runs the entire pipeline (transcribe → extract → label → predict) for a single new audio file.

🧪 Features Used
Feature	Description
num_medications	Total medications mentioned
num_symptoms	Total symptoms detected
num_procedures	Count of tests/treatments found
num_entities	All entities returned by Comprehend
num_adverse_events	Entities matching FAERS list
adverse_event_ratio	Ratio of adverse events to total

🧰 Requirements
Install dependencies via:

bash
Copy
Edit
pip install -r requirements.txt
Minimal requirements.txt:

Copy
Edit
openai-whisper
boto3
pandas
scikit-learn
joblib
⚙️ Configuration
Make sure your AWS credentials are set up for boto3 to use AWS Comprehend Medical.

💾 Model Output
Model file: model/adverse_event_model.pkl

Performance metrics: Precision, Recall, F1 (via evaluate_model.py)

Example predictions: Output in console or saved optionally

📈 Example Output
bash
Copy
Edit
❗ Adverse Event Likely
✔️ No Adverse Event Detected
📌 Notes
Make sure you run Whisper transcription on CPU (FP32 mode).

Keep your AWS billing in check when using Comprehend Medical for large batches.

You can generate synthetic negative samples using simulate_false_examples.py.

👤 Author
Developed by [Your Name], 2025
For research and clinical insight purposes only.

📄 License
MIT License — free to use, modify, and distribute.

yaml
Copy
Edit

---

Let me know if you’d like me to generate a `requirements.txt` or a `.gitignore` file for this repo as well.







